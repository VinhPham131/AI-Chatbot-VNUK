<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VNUK Chatbot</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar active collapsed" id="sidebar">
        <div class="sidebar-header">
            <div class="logo-container" onclick="toggleSidebar()">
                <img src="/static/images/logo.png" alt="VNUK Logo">
            </div>
        </div>
        <div class="sidebar-content">
            <div class="sidebar-item" onclick="selectCategory('Academic program');">
                <span>Academic program</span>
            </div>
            <div class="sidebar-item" onclick="selectCategory('Admission & Institutional Information');">
                <span>Admission & Institutional Information</span>
            </div>
            <div class="sidebar-item" onclick="selectCategory('Study Abroad & Partnership Opportunities');">
                <span>Study Abroad & Partnership Opportunities</span>
            </div>
            <div class="sidebar-item" onclick="selectCategory('Scholarships & Tuition');">
                <span>Scholarships & Tuition</span>
            </div>
            <div class="sidebar-divider"></div>
            <div class="sidebar-item" onclick="clearChat();">
                <span>Clear Chat</span>
            </div>
        </div>
    </div>

    <div class="chat-container sidebar-open-collapsed" id="chatContainer">
        <div class="chat-header">
            <h1>VNUK Chatbot</h1>
        </div>
        
        <div class="chat-messages" id="chatMessages">
            <div class="message bot">
                <div class="message-content">
                    <div class="welcome-message">
                        Hello! How can I help you? Please select one of the following categories:
                    </div>
                    <div class="categories-container" id="categoriesContainer">
                        <div class="category-card" onclick="selectCategory('Academic program')">
                            <span class="category-title">Academic program</span>
                        </div>
                        <div class="category-card" onclick="selectCategory('Admission & Institutional Information')">
                            <span class="category-title">Admission & Institutional Information</span>
                        </div>
                        <div class="category-card" onclick="selectCategory('Study Abroad & Partnership Opportunities')">
                            <span class="category-title">Study Abroad & Partnership Opportunities</span>
                        </div>
                        <div class="category-card" onclick="selectCategory('Scholarships & Tuition')">
                            <span class="category-title">Scholarships & Tuition</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="chat-input-container">
            <div class="chat-input-wrapper">
                <input 
                    type="text" 
                    class="chat-input" 
                    id="chatInput" 
                    placeholder="Type your question..."
                    onkeypress="handleKeyPress(event)"
                >
                <button class="send-button" onclick="sendMessage()">â†’</button>
            </div>
        </div>
    </div>

    <script>
        let categoriesShown = true;

        function selectCategory(categoryName) {
            if (!categoriesShown) return;
            
            categoriesShown = false;
            
            // Hide categories
            const categoriesContainer = document.getElementById('categoriesContainer');
            categoriesContainer.style.display = 'none';
            
            // Add user message
            addMessage(categoryName, 'user');
            
            // Show typing indicator
            showTypingIndicator();
            
            // Simulate bot response (replace with actual API call)
            setTimeout(() => {
                hideTypingIndicator();
                addMessage(`You have selected: ${categoryName}. I can help you with information about this topic. What would you like to know specifically?`, 'bot');
            }, 1000);
        }

        function addMessage(text, sender) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            contentDiv.textContent = text;
            
            messageDiv.appendChild(contentDiv);
            chatMessages.appendChild(messageDiv);
            
            // Scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function showTypingIndicator() {
            const chatMessages = document.getElementById('chatMessages');
            let typingDiv = document.getElementById('typingIndicator');
            
            if (!typingDiv) {
                typingDiv = document.createElement('div');
                typingDiv.id = 'typingIndicator';
                typingDiv.className = 'typing-indicator active';
                typingDiv.innerHTML = `
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                `;
                chatMessages.appendChild(typingDiv);
            } else {
                typingDiv.classList.add('active');
            }
            
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function hideTypingIndicator() {
            const typingDiv = document.getElementById('typingIndicator');
            if (typingDiv) {
                typingDiv.classList.remove('active');
            }
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (message === '') return;
            
            // Hide categories if still showing
            if (categoriesShown) {
                categoriesShown = false;
                document.getElementById('categoriesContainer').style.display = 'none';
            }
            
            addMessage(message, 'user');
            input.value = '';
            
            // Show typing indicator
            showTypingIndicator();
            
            // Simulate bot response (replace with actual API call)
            setTimeout(() => {
                hideTypingIndicator();
                addMessage('Thank you for your question. I\'m processing your question...', 'bot');
            }, 1000);
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const chatContainer = document.getElementById('chatContainer');
            
            if (sidebar.classList.contains('active')) {
                // If sidebar is open, toggle collapsed state
                sidebar.classList.toggle('collapsed');
                if (sidebar.classList.contains('collapsed')) {
                    chatContainer.classList.remove('sidebar-open');
                    chatContainer.classList.add('sidebar-open-collapsed');
                } else {
                    chatContainer.classList.remove('sidebar-open-collapsed');
                    chatContainer.classList.add('sidebar-open');
                }
            } else {
                // If sidebar is closed, open it
                sidebar.classList.add('active');
                chatContainer.classList.add('sidebar-open');
                sidebar.classList.remove('collapsed');
                chatContainer.classList.remove('sidebar-open-collapsed');
            }
        }

        function clearChat() {
            const chatMessages = document.getElementById('chatMessages');
            chatMessages.innerHTML = '';
            categoriesShown = true;
            
            // Reset to initial state
            const welcomeDiv = document.createElement('div');
            welcomeDiv.className = 'message bot';
            welcomeDiv.innerHTML = `
                <div class="message-content">
                    <div class="welcome-message">
                        Hello! How can I help you? Please select one of the following categories:
                    </div>
                    <div class="categories-container" id="categoriesContainer">
                        <div class="category-card" onclick="selectCategory('Academic program')">
                            <span class="category-title">Academic program</span>
                        </div>
                        <div class="category-card" onclick="selectCategory('Admission & Institutional Information')">
                            <span class="category-title">Admission & Institutional Information</span>
                        </div>
                        <div class="category-card" onclick="selectCategory('Study Abroad & Partnership Opportunities')">
                            <span class="category-title">Study Abroad & Partnership Opportunities</span>
                        </div>
                        <div class="category-card" onclick="selectCategory('Scholarships & Tuition')">
                            <span class="category-title">Scholarships & Tuition</span>
                        </div>
                    </div>
                </div>
            `;
            chatMessages.appendChild(welcomeDiv);
        }
    </script>
</body>
</html>
